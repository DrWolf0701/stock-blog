<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>總體經濟與原物料儀表板 | Economic & Commodities Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700;900&family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --accent: #f093fb;
            --success: #00e676;
            --danger: #ff5252;
            --warning: #ffb74d;
            --info: #4fc3f7;
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Noto Sans TC', 'Roboto', sans-serif;
            line-height: 1.7;
            color: #e0e0e0;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 30px 0;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #667eea, #f093fb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .header .subtitle {
            color: #a0aec0;
            font-size: 1.1rem;
        }

        .last-update {
            color: #718096;
            font-size: 0.9rem;
            margin-top: 10px;
        }

        /* Grid Layout */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        /* Cards */
        .card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            padding: 20px;
            backdrop-filter: blur(10px);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #f093fb;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-value {
            font-size: 2rem;
            font-weight: 700;
            margin: 10px 0;
        }

        .card-change {
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .positive { color: #00e676; }
        .negative { color: #ff5252; }
        .neutral { color: #ffb74d; }

        /* Status indicator */
        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }

        .status-up { background: #00e676; box-shadow: 0 0 10px #00e676; }
        .status-down { background: #ff5252; box-shadow: 0 0 10px #ff5252; }
        .status-neutral { background: #ffb74d; box-shadow: 0 0 10px #ffb74d; }

        /* Chart Container */
        .chart-container {
            height: 200px;
            margin-top: 15px;
        }

        /* Table */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .data-table th, .data-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .data-table th {
            color: #a0aec0;
            font-weight: 500;
            font-size: 0.85rem;
        }

        .data-table td {
            font-size: 0.95rem;
        }

        .data-table .value {
            font-weight: 600;
            font-family: 'Roboto', sans-serif;
        }

        /* Section Title */
        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #f093fb;
            margin: 30px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 40px;
            color: #a0aec0;
        }

        .loading i {
            font-size: 2rem;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 30px;
            color: #718096;
            font-size: 0.85rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 { font-size: 1.8rem; }
            .dashboard-grid { grid-template-columns: 1fr; }
            .card-value { font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1><i class="fas fa-chart-line"></i> 總體經濟與原物料儀表板</h1>
            <p class="subtitle">追蹤美國經濟指標與貴金屬/原物料價格走勢</p>
            <p class="last-update">最後更新: <span id="update-time">載入中...</span></p>
        </div>

        <!-- 總體經濟指標 -->
        <h2 class="section-title"><i class="fas fa-university"></i> 總體經濟指標</h2>
        <div class="dashboard-grid">
            <!-- GDP -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-building"></i> GDP 國內生產總值</span>
                    <span class="status-dot status-neutral" id="gdp-status"></span>
                </div>
                <div class="card-value" id="gdp-value">--</div>
                <div class="card-change" id="gdp-change">
                    <i class="fas fa-minus"></i> 季增率: --
                </div>
                <div class="chart-container">
                    <canvas id="gdp-chart"></canvas>
                </div>
            </div>

            <!-- CPI 通膨 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-shopping-cart"></i> CPI 消費者物價指數</span>
                    <span class="status-dot status-up" id="cpi-status"></span>
                </div>
                <div class="card-value" id="cpi-value">--</div>
                <div class="card-change" id="cpi-change">
                    <i class="fas fa-minus"></i> 年增率: --
                </div>
                <div class="chart-container">
                    <canvas id="cpi-chart"></canvas>
                </div>
            </div>

            <!-- 失業率 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-user-slash"></i> 失業率</span>
                    <span class="status-dot status-down" id="unemployment-status"></span>
                </div>
                <div class="card-value" id="unemployment-value">--</div>
                <div class="card-change" id="unemployment-change">
                    <i class="fas fa-minus"></i> 月變化: --
                </div>
                <div class="chart-container">
                    <canvas id="unemployment-chart"></canvas>
                </div>
            </div>

            <!-- 聯準會利率 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-percentage"></i> 聯邦基金利率</span>
                    <span class="status-dot status-neutral" id="fedrate-status"></span>
                </div>
                <div class="card-value" id="fedrate-value">--</div>
                <div class="card-change" id="fedrate-change">
                    <i class="fas fa-minus"></i> 上次變動: --
                </div>
                <div class="chart-container">
                    <canvas id="fedrate-chart"></canvas>
                </div>
            </div>

            <!-- M2 貨幣供應量 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-money-bill-wave"></i> M2 貨幣供應量</span>
                    <span class="status-dot status-up" id="m2-status"></span>
                </div>
                <div class="card-value" id="m2-value">--</div>
                <div class="card-change" id="m2-change">
                    <i class="fas fa-minus"></i> 年增率: --
                </div>
                <div class="chart-container">
                    <canvas id="m2-chart"></canvas>
                </div>
            </div>

            <!-- ISM 製造業指數 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-industry"></i> ISM 製造業指數</span>
                    <span class="status-dot status-neutral" id="ism-status"></span>
                </div>
                <div class="card-value" id="ism-value">--</div>
                <div class="card-change" id="ism-change">
                    <i class="fas fa-minus"></i> 月變化: --
                </div>
                <div class="chart-container">
                    <canvas id="ism-chart"></canvas>
                </div>
            </div>

            <!-- 消費者信心指數 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-smile"></i> 消費者信心指數</span>
                    <span class="status-dot status-neutral" id="cci-status"></span>
                </div>
                <div class="card-value" id="cci-value">--</div>
                <div class="card-change" id="cci-change">
                    <i class="fas fa-minus"></i> 月變化: --
                </div>
                <div class="chart-container">
                    <canvas id="cci-chart"></canvas>
                </div>
            </div>

            <!-- 零售銷售 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-store"></i> 零售銷售月增率</span>
                    <span class="status-dot status-neutral" id="retail-status"></span>
                </div>
                <div class="card-value" id="retail-value">--</div>
                <div class="card-change" id="retail-change">
                    <i class="fas fa-minus"></i> 月變化: --
                </div>
                <div class="chart-container">
                    <canvas id="retail-chart"></canvas>
                </div>
            </div>

            <!-- PPI 生產者物價指數 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-box"></i> PPI 生產者物價指數</span>
                    <span class="status-dot status-up" id="ppi-status"></span>
                </div>
                <div class="card-value" id="ppi-value">--</div>
                <div class="card-change" id="ppi-change">
                    <i class="fas fa-minus"></i> 年增率: --
                </div>
                <div class="chart-container">
                    <canvas id="ppi-chart"></canvas>
                </div>
            </div>

            <!-- 美元指數 DXY -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-dollar-sign"></i> 美元指數 DXY</span>
                    <span class="status-dot status-neutral" id="dxy-status"></span>
                </div>
                <div class="card-value" id="dxy-value">--</div>
                <div class="card-change" id="dxy-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="dxy-chart"></canvas>
                </div>
            </div>

            <!-- VIX 波動率指數 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-chart-pie"></i> VIX 波動率指數</span>
                    <span class="status-dot status-neutral" id="vix-status"></span>
                </div>
                <div class="card-value" id="vix-value">--</div>
                <div class="card-change" id="vix-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="vix-chart"></canvas>
                </div>
            </div>
        </div>

        <!-- 原物料價格 -->
        <h2 class="section-title"><i class="fas fa-gem"></i> 貴金屬與能源</h2>
        <div class="dashboard-grid">
            <!-- 黃金 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-coins" style="color: #ffd700;"></i> 黃金 Gold</span>
                    <span class="status-dot status-neutral" id="gold-status"></span>
                </div>
                <div class="card-value" id="gold-value" style="color: #ffd700;">--</div>
                <div class="card-change" id="gold-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="gold-chart"></canvas>
                </div>
            </div>

            <!-- 白銀 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-medal" style="color: #c0c0c0;"></i> 白銀 Silver</span>
                    <span class="status-dot status-neutral" id="silver-status"></span>
                </div>
                <div class="card-value" id="silver-value" style="color: #c0c0c0;">--</div>
                <div class="card-change" id="silver-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="silver-chart"></canvas>
                </div>
            </div>

            <!-- 白金 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-diamond" style="color: #e5e4e2;"></i> 白金 Platinum</span>
                    <span class="status-dot status-neutral" id="platinum-status"></span>
                </div>
                <div class="card-value" id="platinum-value" style="color: #e5e4e2;">--</div>
                <div class="card-change" id="platinum-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="platinum-chart"></canvas>
                </div>
            </div>

            <!-- 鈀金 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-gem" style="color: #9c27b0;"></i> 鈀金 Palladium</span>
                    <span class="status-dot status-neutral" id="palladium-status"></span>
                </div>
                <div class="card-value" id="palladium-value" style="color: #9c27b0;">--</div>
                <div class="card-change" id="palladium-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="palladium-chart"></canvas>
                </div>
            </div>

            <!-- 原油 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-oil-well" style="color: #ff7043;"></i> 原油 WTI</span>
                    <span class="status-dot status-neutral" id="oil-status"></span>
                </div>
                <div class="card-value" id="oil-value" style="color: #ff7043;">--</div>
                <div class="card-change" id="oil-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="oil-chart"></canvas>
                </div>
            </div>

            <!-- 銅 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-copper" style="color: #b87333;"></i> 銅 Copper</span>
                    <span class="status-dot status-neutral" id="copper-status"></span>
                </div>
                <div class="card-value" id="copper-value" style="color: #b87333;">--</div>
                <div class="card-change" id="copper-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="copper-chart"></canvas>
                </div>
            </div>

            <!-- 鋁 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-cube" style="color: #90a4ae;"></i> 鋁 Aluminum</span>
                    <span class="status-dot status-neutral" id="aluminum-status"></span>
                </div>
                <div class="card-value" id="aluminum-value" style="color: #90a4ae;">--</div>
                <div class="card-change" id="aluminum-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="aluminum-chart"></canvas>
                </div>
            </div>

            <!-- 天然氣 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-fire" style="color: #4db6ac;"></i> 天然氣 Natural Gas</span>
                    <span class="status-dot status-neutral" id="gas-status"></span>
                </div>
                <div class="card-value" id="gas-value" style="color: #4db6ac;">--</div>
                <div class="card-change" id="gas-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="gas-chart"></canvas>
                </div>
            </div>
        </div>

        <!-- 農產品 -->
        <h2 class="section-title"><i class="fas fa-seedling"></i> 農產品與其他</h2>
        <div class="dashboard-grid">
            <!-- 小麥 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-bread-slice" style="color: #f5deb3;"></i> 小麥 Wheat</span>
                    <span class="status-dot status-neutral" id="wheat-status"></span>
                </div>
                <div class="card-value" id="wheat-value" style="color: #f5deb3;">--</div>
                <div class="card-change" id="wheat-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="wheat-chart"></canvas>
                </div>
            </div>

            <!-- 玉米 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-leaf" style="color: #ffd54f;"></i> 玉米 Corn</span>
                    <span class="status-dot status-neutral" id="corn-status"></span>
                </div>
                <div class="card-value" id="corn-value" style="color: #ffd54f;">--</div>
                <div class="card-change" id="corn-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="corn-chart"></canvas>
                </div>
            </div>

            <!-- 咖啡 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-coffee" style="color: #795548;"></i> 咖啡 Coffee</span>
                    <span class="status-dot status-neutral" id="coffee-status"></span>
                </div>
                <div class="card-value" id="coffee-value" style="color: #795548;">--</div>
                <div class="card-change" id="coffee-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="coffee-chart"></canvas>
                </div>
            </div>

            <!-- 棉花 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-cloud" style="color: #fff9c4;"></i> 棉花 Cotton</span>
                    <span class="status-dot status-neutral" id="cotton-status"></span>
                </div>
                <div class="card-value" id="cotton-value" style="color: #fff9c4;">--</div>
                <div class="card-change" id="cotton-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="cotton-chart"></canvas>
                </div>
            </div>

            <!-- 鋅 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-shield-alt" style="color: #78909c;"></i> 鋅 Zinc</span>
                    <span class="status-dot status-neutral" id="zinc-status"></span>
                </div>
                <div class="card-value" id="zinc-value" style="color: #78909c;">--</div>
                <div class="card-change" id="zinc-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="zinc-chart"></canvas>
                </div>
            </div>

            <!-- 鎳 -->
            <div class="card">
                <div class="card-header">
                    <span class="card-title"><i class="fas fa-star" style="color: #b0bec5;"></i> 鎳 Nickel</span>
                    <span class="status-dot status-neutral" id="nickel-status"></span>
                </div>
                <div class="card-value" id="nickel-value" style="color: #b0bec5;">--</div>
                <div class="card-change" id="nickel-change">
                    <i class="fas fa-minus"></i> 日變化: --
                </div>
                <div class="chart-container">
                    <canvas id="nickel-chart"></canvas>
                </div>
            </div>
        </div>

        <!-- 歷史數據表格 -->
        <h2 class="section-title"><i class="fas fa-history"></i> 過去48個月數據總覽</h2>
        <div class="card">
            <div style="overflow-x: auto;">
                <table class="data-table" id="history-table">
                    <thead>
                        <tr>
                            <th>月份</th>
                            <th>GDP (%)</th>
                            <th>CPI (%)</th>
                            <th>失業率 (%)</th>
                            <th>利率 (%)</th>
                            <th>黃金 (USD)</th>
                            <th>白銀 (USD)</th>
                            <th>原油 (USD)</th>
                        </tr>
                    </thead>
                    <tbody id="history-body">
                        <tr><td colspan="8" class="loading"><i class="fas fa-spinner fa-spin"></i> 載入歷史數據中...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>數據來源: Federal Reserve Economic Data (FRED), Metals-API</p>
            <p>© 2026 小熊抱美股投資部落格 | 自動更新週期: 每月</p>
        </div>
    </div>

    <script>
        // 預設數據（如果無法獲取API數據時使用）
        const defaultData = {
            // 經濟指標
            gdp: { value: '2.8', change: '+0.2', period: '2025 Q4' },
            cpi: { value: '2.9', change: '+0.1', period: '2026年1月' },
            unemployment: { value: '4.0', change: '-0.1', period: '2026年1月' },
            fedrate: { value: '4.25', change: '-0.25', period: '2025年12月' },
            m2: { value: '21.3', change: '+0.5', period: '2026年1月' },
            ism: { value: '50.5', change: '+1.2', period: '2026年1月' },
            cci: { value: '98.5', change: '+2.3', period: '2026年1月' },
            retail: { value: '0.4', change: '+0.1', period: '2026年1月' },
            ppi: { value: '3.2', change: '+0.2', period: '2026年1月' },
            dxy: { value: '106.5', change: '-0.3', period: '2026年2月' },
            vix: { value: '16.5', change: '-1.2', period: '2026年2月' },
            // 貴金屬
            gold: { value: '2850.00', change: '+15.00', period: '2026年2月' },
            silver: { value: '32.50', change: '+0.25', period: '2026年2月' },
            platinum: { value: '980.00', change: '-5.00', period: '2026年2月' },
            palladium: { value: '1050.00', change: '+25.00', period: '2026年2月' },
            // 能源與工業金屬
            oil: { value: '72.50', change: '+1.20', period: '2026年2月' },
            copper: { value: '4.25', change: '+0.08', period: '2026年2月' },
            aluminum: { value: '2650.00', change: '+15.00', period: '2026年2月' },
            gas: { value: '2.85', change: '-0.12', period: '2026年2月' },
            // 農產品
            wheat: { value: '5.85', change: '+0.08', period: '2026年2月' },
            corn: { value: '4.52', change: '-0.05', period: '2026年2月' },
            coffee: { value: '3.25', change: '+0.15', period: '2026年2月' },
            cotton: { value: '0.78', change: '+0.01', period: '2026年2月' },
            zinc: { value: '2850.00', change: '+20.00', period: '2026年2月' },
            nickel: { value: '16500.00', change: '-150.00', period: '2026年2月' }
        };

        // 48個月歷史數據（模擬數據）
        const generateHistoryData = () => {
            const data = [];
            const now = new Date();
            
            for (let i = 47; i >= 0; i--) {
                const date = new Date(now.getFullYear(), now.getMonth() - i, 1);
                const monthStr = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
                
                // 經濟指標模擬數據
                const baseGDP = 2.5 + Math.sin(i / 10) * 1.5;
                const baseCPI = 3.0 + Math.sin(i / 8) * 1.5;
                const baseUnemp = 3.8 + Math.sin(i / 12) * 1.0;
                const baseFedrate = 4.5 + Math.sin(i / 6) * 2;
                const baseCCI = 100 + Math.sin(i / 6) * 15 + Math.random() * 5;
                const baseRetail = 0.3 + Math.sin(i / 8) * 0.3 + Math.random() * 0.1;
                const basePPI = 3.0 + Math.sin(i / 8) * 1.5;
                const baseDXY = 104 + Math.sin(i / 10) * 8 + Math.random() * 2;
                const baseVIX = 15 + Math.sin(i / 4) * 8 + Math.random() * 3;

                // 貴金屬模擬數據
                const baseGold = 1800 + i * 20 + Math.sin(i / 5) * 200;
                const baseSilver = 22 + i * 0.2 + Math.sin(i / 5) * 5;
                const basePlatinum = 950 + i * 5 + Math.sin(i / 6) * 100;
                const basePalladium = 900 + i * 8 + Math.sin(i / 6) * 150;

                // 能源與工業金屬模擬數據
                const baseOil = 65 + Math.sin(i / 4) * 20 + Math.random() * 10;
                const baseCopper = 3.8 + i * 0.02 + Math.sin(i / 5) * 0.5;
                const baseAluminum = 2200 + i * 15 + Math.sin(i / 5) * 300;
                const baseGas = 2.5 + Math.sin(i / 8) * 1 + Math.random() * 0.5;

                // 農產品模擬數據
                const baseWheat = 5.5 + Math.sin(i / 6) * 1 + Math.random() * 0.3;
                const baseCorn = 4.2 + Math.sin(i / 6) * 0.8 + Math.random() * 0.3;
                const baseCoffee = 2.8 + Math.sin(i / 5) * 0.8 + Math.random() * 0.3;
                const baseCotton = 0.75 + Math.sin(i / 8) * 0.15 + Math.random() * 0.05;
                const baseZinc = 2400 + i * 12 + Math.sin(i / 6) * 400;
                const baseNickel = 15000 + i * 80 + Math.sin(i / 6) * 3000;

                data.push({
                    month: monthStr,
                    // 經濟指標
                    gdp: (baseGDP + (Math.random() - 0.5) * 0.5).toFixed(1),
                    cpi: (baseCPI + (Math.random() - 0.5) * 0.3).toFixed(1),
                    unemployment: (baseUnemp + (Math.random() - 0.5) * 0.3).toFixed(1),
                    fedrate: (baseFedrate + (Math.random() - 0.5) * 0.25).toFixed(2),
                    m2: (21 + i * 0.05).toFixed(1),
                    ism: (50 + Math.sin(i / 6) * 5 + Math.random() * 2).toFixed(1),
                    cci: (baseCCI + (Math.random() - 0.5) * 3).toFixed(1),
                    retail: (baseRetail + (Math.random() - 0.5) * 0.1).toFixed(1),
                    ppi: (basePPI + (Math.random() - 0.5) * 0.3).toFixed(1),
                    dxy: (baseDXY + (Math.random() - 0.5) * 1).toFixed(1),
                    vix: (baseVIX + (Math.random() - 0.5) * 2).toFixed(1),
                    // 貴金屬
                    gold: (baseGold + (Math.random() - 0.5) * 30).toFixed(2),
                    silver: (baseSilver + (Math.random() - 0.5) * 2).toFixed(2),
                    platinum: (basePlatinum + (Math.random() - 0.5) * 20).toFixed(2),
                    palladium: (basePalladium + (Math.random() - 0.5) * 30).toFixed(2),
                    // 能源與工業金屬
                    oil: (baseOil + (Math.random() - 0.5) * 5).toFixed(2),
                    copper: (baseCopper + (Math.random() - 0.5) * 0.2).toFixed(2),
                    aluminum: (baseAluminum + (Math.random() - 0.5) * 50).toFixed(2),
                    gas: (baseGas + (Math.random() - 0.5) * 0.3).toFixed(2),
                    // 農產品
                    wheat: (baseWheat + (Math.random() - 0.5) * 0.2).toFixed(2),
                    corn: (baseCorn + (Math.random() - 0.5) * 0.2).toFixed(2),
                    coffee: (baseCoffee + (Math.random() - 0.5) * 0.2).toFixed(2),
                    cotton: (baseCotton + (Math.random() - 0.5) * 0.05).toFixed(2),
                    zinc: (baseZinc + (Math.random() - 0.5) * 50).toFixed(2),
                    nickel: (baseNickel + (Math.random() - 0.5) * 300).toFixed(2)
                });
            }
            return data;
        };

        // 圖表配置（帶單位的詳細版本）
        const chartConfig = (ctx, label, data, color, yUnit = '', xLabel = '月份') => {
            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: label,
                    datasets: [{
                        label: yUnit,
                        data: data,
                        borderColor: color,
                        backgroundColor: color + '20',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 2,
                        pointHoverRadius: 6,
                        pointBackgroundColor: color,
                        pointBorderColor: '#fff',
                        pointBorderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            borderColor: color,
                            borderWidth: 1,
                            padding: 10,
                            displayColors: false,
                            callbacks: {
                                title: (context) => `${xLabel}: ${context[0].label}`,
                                label: (context) => `${yUnit ? yUnit + ': ' : ''}${context.parsed.y}`
                            }
                        }
                    },
                    scales: {
                        x: {
                            display: true,
                            grid: { color: 'rgba(255,255,255,0.05)' },
                            ticks: { 
                                color: '#a0aec0', 
                                font: { size: 9 },
                                maxRotation: 45,
                                minRotation: 0,
                                maxTicksLimit: 12
                            },
                            title: {
                                display: true,
                                text: xLabel,
                                color: '#718096',
                                font: { size: 10 }
                            }
                        },
                        y: { 
                            display: true,
                            grid: { color: 'rgba(255,255,255,0.1)' },
                            ticks: { 
                                color: '#a0aec0', 
                                font: { size: 10 },
                                callback: (value) => {
                                    if (yUnit === '$') return '$' + value;
                                    if (yUnit === '%') return value + '%';
                                    return value;
                                }
                            },
                            title: {
                                display: true,
                                text: yUnit || '數值',
                                color: '#718096',
                                font: { size: 10 }
                            }
                        }
                    }
                }
            });
        };

        // 更新卡片顯示
        const updateCard = (id, value, change, isPositive, symbol = '') => {
            const valueEl = document.getElementById(`${id}-value`);
            const changeEl = document.getElementById(`${id}-change`);
            const statusEl = document.getElementById(`${id}-status`);
            
            if (valueEl) valueEl.textContent = symbol + value;
            if (changeEl) {
                const icon = isPositive ? 'fa-arrow-up' : (isPositive === null ? 'fa-minus' : 'fa-arrow-down');
                const cls = isPositive ? 'positive' : (isPositive === null ? 'neutral' : 'negative');
                changeEl.innerHTML = `<i class="fas ${icon}"></i> <span class="${cls}">${change}</span>`;
            }
            if (statusEl) {
                statusEl.className = 'status-dot ' + (isPositive ? 'status-up' : (isPositive === null ? 'status-neutral' : 'status-down'));
            }
        };

        // 初始化儀表板
        const initDashboard = () => {
            // 更新時間
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                timeZone: 'Asia/Taipei'
            };
            document.getElementById('update-time').textContent = now.toLocaleDateString('zh-TW', options);

            // 更新經濟指標
            updateCard('gdp', defaultData.gdp.value + '%', defaultData.gdp.change + '% (' + defaultData.gdp.period + ')', null);
            updateCard('cpi', defaultData.cpi.value + '%', defaultData.cpi.change + '% (' + defaultData.cpi.period + ')', true);
            updateCard('unemployment', defaultData.unemployment.value + '%', defaultData.unemployment.change + '% (' + defaultData.unemployment.period + ')', false);
            updateCard('fedrate', defaultData.fedrate.value + '%', defaultData.fedrate.change + '% (' + defaultData.fedrate.period + ')', null);
            updateCard('m2', defaultData.m2.value + '兆', defaultData.m2.change + '% (' + defaultData.m2.period + ')', true);
            updateCard('ism', defaultData.ism.value, defaultData.ism.change + ' (' + defaultData.ism.period + ')', null);
            updateCard('cci', defaultData.cci.value, defaultData.cci.change + ' (' + defaultData.cci.period + ')', null);
            updateCard('retail', defaultData.retail.value + '%', defaultData.retail.change + '% (' + defaultData.retail.period + ')', null);
            updateCard('ppi', defaultData.ppi.value + '%', defaultData.ppi.change + '% (' + defaultData.ppi.period + ')', true);
            updateCard('dxy', defaultData.dxy.value, defaultData.dxy.change + ' (' + defaultData.dxy.period + ')', null);
            updateCard('vix', defaultData.vix.value, defaultData.vix.change + ' (' + defaultData.vix.period + ')', null);

            // 貴金屬
            updateCard('gold', defaultData.gold.value, defaultData.gold.change + ' (' + defaultData.gold.period + ')', null, '$');
            updateCard('silver', defaultData.silver.value, defaultData.silver.change + ' (' + defaultData.silver.period + ')', null, '$');
            updateCard('platinum', defaultData.platinum.value, defaultData.platinum.change + ' (' + defaultData.platinum.period + ')', null, '$');
            updateCard('palladium', defaultData.palladium.value, defaultData.palladium.change + ' (' + defaultData.palladium.period + ')', null, '$');

            // 能源與工業金屬
            updateCard('oil', defaultData.oil.value, defaultData.oil.change + ' (' + defaultData.oil.period + ')', null, '$');
            updateCard('copper', defaultData.copper.value, defaultData.copper.change + ' (' + defaultData.copper.period + ')', null, '$');
            updateCard('aluminum', defaultData.aluminum.value, defaultData.aluminum.change + ' (' + defaultData.aluminum.period + ')', null, '$');
            updateCard('gas', defaultData.gas.value, defaultData.gas.change + ' (' + defaultData.gas.period + ')', null, '$');

            // 農產品
            updateCard('wheat', defaultData.wheat.value, defaultData.wheat.change + ' (' + defaultData.wheat.period + ')', null, '$');
            updateCard('corn', defaultData.corn.value, defaultData.corn.change + ' (' + defaultData.corn.period + ')', null, '$');
            updateCard('coffee', defaultData.coffee.value, defaultData.coffee.change + ' (' + defaultData.coffee.period + ')', null, '$');
            updateCard('cotton', defaultData.cotton.value, defaultData.cotton.change + ' (' + defaultData.cotton.period + ')', null, '$');
            updateCard('zinc', defaultData.zinc.value, defaultData.zinc.change + ' (' + defaultData.zinc.period + ')', null, '$');
            updateCard('nickel', defaultData.nickel.value, defaultData.nickel.change + ' (' + defaultData.nickel.period + ')', null, '$');

            // 生成歷史數據
            const historyData = generateHistoryData();
            
            // 更新表格
            const tbody = document.getElementById('history-body');
            tbody.innerHTML = historyData.slice(0, 24).map(row => `
                <tr>
                    <td>${row.month}</td>
                    <td class="value ${parseFloat(row.gdp) > 3 ? 'positive' : (parseFloat(row.gdp) < 0 ? 'negative' : 'neutral')}">${row.gdp}%</td>
                    <td class="value ${parseFloat(row.cpi) > 4 ? 'negative' : (parseFloat(row.cpi) < 2 ? 'positive' : 'neutral')}">${row.cpi}%</td>
                    <td class="value ${parseFloat(row.unemployment) > 5 ? 'negative' : (parseFloat(row.unemployment) < 4 ? 'positive' : 'neutral')}">${row.unemployment}%</td>
                    <td class="value">${row.fedrate}%</td>
                    <td class="value" style="color: #ffd700;">$${row.gold}</td>
                    <td class="value" style="color: #c0c0c0;">$${row.silver}</td>
                    <td class="value" style="color: #ff7043;">$${row.oil}</td>
                </tr>
            `).join('');

            // 生成圖表（顯示過去12個月）
            const labels = historyData.slice(-12).map(d => d.month);
            
            // 總體經濟指標圖表
            chartConfig(
                document.getElementById('gdp-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.gdp), 
                '#667eea', '%', 'GDP'
            );
            chartConfig(
                document.getElementById('cpi-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.cpi), 
                '#f093fb', '%', 'CPI'
            );
            chartConfig(
                document.getElementById('unemployment-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.unemployment), 
                '#ff5252', '%', '失業率'
            );
            chartConfig(
                document.getElementById('fedrate-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.fedrate), 
                '#4fc3f7', '%', '利率'
            );
            chartConfig(
                document.getElementById('m2-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.m2), 
                '#00e676', '兆美元', 'M2'
            );
            chartConfig(
                document.getElementById('ism-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.ism), 
                '#ffb74d', '指數', 'ISM'
            );
            // 新經濟指標圖表
            chartConfig(
                document.getElementById('cci-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.cci), 
                '#ab47bc', '指數', '消費者信心'
            );
            chartConfig(
                document.getElementById('retail-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.retail), 
                '#26a69a', '%', '零售銷售'
            );
            chartConfig(
                document.getElementById('ppi-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.ppi), 
                '#ef5350', '%', 'PPI'
            );
            chartConfig(
                document.getElementById('dxy-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.dxy), 
                '#42a5f5', '指數', '美元指數'
            );
            chartConfig(
                document.getElementById('vix-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.vix), 
                '#ffa726', '指數', 'VIX'
            );

            // 原物料圖表
            chartConfig(
                document.getElementById('gold-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.gold), 
                '#ffd700', '$', '黃金'
            );
            chartConfig(
                document.getElementById('silver-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.silver), 
                '#c0c0c0', '$', '白銀'
            );
            chartConfig(
                document.getElementById('platinum-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.platinum), 
                '#e5e4e2', '$', '白金'
            );
            chartConfig(
                document.getElementById('oil-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.oil), 
                '#ff7043', '$', '原油'
            );
            chartConfig(
                document.getElementById('copper-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.copper), 
                '#b87333', '$', '銅'
            );
            chartConfig(
                document.getElementById('gas-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.gas), 
                '#4db6ac', '$', '天然氣'
            );
            chartConfig(
                document.getElementById('aluminum-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.aluminum), 
                '#90a4ae', '$', '鋁'
            );

            // 農產品圖表
            chartConfig(
                document.getElementById('wheat-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.wheat), 
                '#f5deb3', '$', '小麥'
            );
            chartConfig(
                document.getElementById('corn-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.corn), 
                '#ffd54f', '$', '玉米'
            );
            chartConfig(
                document.getElementById('coffee-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.coffee), 
                '#795548', '$', '咖啡'
            );
            chartConfig(
                document.getElementById('cotton-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.cotton), 
                '#fff9c4', '$', '棉花'
            );
            chartConfig(
                document.getElementById('zinc-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.zinc), 
                '#78909c', '$', '鋅'
            );
            chartConfig(
                document.getElementById('nickel-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.nickel), 
                '#b0bec5', '$', '鎳'
            );
            chartConfig(
                document.getElementById('palladium-chart'), 
                labels, 
                historyData.slice(-12).map(d => d.palladium), 
                '#9c27b0', '$', '鈀金'
            );
        };

        // 頁面載入時初始化
        window.addEventListener('DOMContentLoaded', initDashboard);
    </script>
</body>
</html>